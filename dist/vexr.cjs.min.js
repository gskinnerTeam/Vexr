"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var asyncGenerator=function(){function e(e){this.value=e}function t(t){function n(e,t){return new Promise(function(n,i){var s={key:e,arg:t,resolve:n,reject:i,next:null};a?a=a.next=s:(o=a=s,r(e,t))})}function r(n,o){try{var a=t[n](o),s=a.value;s instanceof e?Promise.resolve(s.value).then(function(e){r("next",e)},function(e){r("throw",e)}):i(a.done?"return":"normal",a.value)}catch(e){i("throw",e)}}function i(e,t){switch(e){case"return":o.resolve({value:t,done:!0});break;case"throw":o.reject(t);break;default:o.resolve({value:t,done:!1})}o=o.next,o?r(o.key,o.arg):a=null}var o,a;this._invoke=n,"function"!=typeof t.return&&(this.return=void 0)}return"function"==typeof Symbol&&Symbol.asyncIterator&&(t.prototype[Symbol.asyncIterator]=function(){return this}),t.prototype.next=function(e){return this._invoke("next",e)},t.prototype.throw=function(e){return this._invoke("throw",e)},t.prototype.return=function(e){return this._invoke("return",e)},{wrap:function(e){return function(){return new t(e.apply(this,arguments))}},await:function(t){return new e(t)}}}(),classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),get$1=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},inherits=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},possibleConstructorReturn=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},set$1=function e(t,n,r,i){var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var a=Object.getPrototypeOf(t);null!==a&&e(a,n,r,i)}else if("value"in o&&o.writable)o.value=r;else{var s=o.set;void 0!==s&&s.call(i,r)}return r},Convert=function(){function e(){classCallCheck(this,e)}return createClass(e,null,[{key:"RadiansToDegrees",value:function(e){return e*(180/Math.PI)}},{key:"DegreesToRadians",value:function(e){return e*(Math.PI/180)}},{key:"MapRange",value:function(e,t,n,r,i){return r+(i-r)*(e-t)/(n-t)}}]),e}(),Vector2=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;classCallCheck(this,e),this.raw=[t,n]}return createClass(e,null,[{key:"angleBetween",value:function(t,n){var r=t.magnitude()*n.magnitude(),i=e.dot(t,n);return Math.acos(i/r)}},{key:"lerp",value:function(t,n,r){var i=t.x+r*(n.x-t.x),o=t.y+r*(n.y-t.y);return new e(i,o)}},{key:"normalize",value:function(e){var t=e.get();return t.normalize(),t}},{key:"magnitude",value:function(t){return Math.sqrt(e.dot(t,t))}},{key:"add",value:function(t,n){return new e(t.x+n.x,t.y+n.y)}},{key:"subtract",value:function(t,n){var r=new e(n.x,n.y);return r.negate(),e.add(t,r)}},{key:"multiply",value:function(t,n){return new e(t.x*n,t.y*n)}},{key:"divide",value:function(t,n){return n=1/n,e.multiply(t,n)}},{key:"dot",value:function(e,t){return e.x*t.x+e.y*t.y}},{key:"dist",value:function(e,t){var n=e.x-t.x,r=e.y-t.y;return Math.sqrt(n*n+r*r)}}]),createClass(e,[{key:"get",value:function(){return new e(this.x,this.y)}},{key:"set",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.x=e,this.y=t}},{key:"multiply",value:function(e){this.x=this.x*e,this.y=this.y*e}},{key:"add",value:function(e){this.x=this.x+e.x,this.y=this.y+e.y}},{key:"subtract",value:function(t){var n=new e(t.x,t.y);n.negate(),this.add(n)}},{key:"divide",value:function(e){e=1/e,this.multiply(e)}},{key:"negate",value:function(){this.x=-this.x,this.y=-this.y}},{key:"clamp",value:function(e){this.x>e?this.x=e:this.x<0&&this.x<e&&(this.x=-e),this.y>e?this.y=e:this.y<0&&this.y<e&&(this.y=-e)}},{key:"limit",value:function(e){this.magnitude()>e&&(this.normalize(),this.multiply(e))}},{key:"rotate",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new e(0,0),r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.magnitude(),o=Convert.degreesToRadians(t),a=Math.cos(o),s=Math.sin(o);this.x=a*(this.x-n.x)+s*(this.y-n.y)+n.x,this.y=a*(this.y-n.y)-s*(this.x-n.x)+n.y,r&&(this.normalize(),this.multiply(i))}},{key:"magnitude",value:function(){return Math.sqrt(e.dot(this,this))}},{key:"normalize",value:function(){var e=this.magnitude();e>0&&this.divide(e)}},{key:"x",get:function(){return this.raw[0]},set:function(e){this.raw[0]=e}},{key:"y",get:function(){return this.raw[1]},set:function(e){this.raw[1]=e}},{key:"z",get:function(){return 0}}]),e}(),Vector3=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;classCallCheck(this,e),this.raw=[t,n,r]}return createClass(e,null,[{key:"reset",value:function(e){e.set(0,0,0)}},{key:"angleBetween",value:function(t,n){var r=t.magnitude()*n.magnitude(),i=e.dot(t,n);return Math.acos(i/r)}},{key:"lerp",value:function(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new e;return i.set(t.x+r*(n.x-t.x),t.y+r*(n.y-t.y),t.z+r*(n.z-t.z)),i}},{key:"normalize",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new e,r=t.get(n);return r.normalize(),r}},{key:"magnitude",value:function(t){return Math.sqrt(e.dot(t,t))}},{key:"add",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new e;return r.set(t.x+n.x,t.y+n.y,t.z+n.z),r}},{key:"subtract",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new e;return r.set(t.x-n.x,t.y-n.y,t.z-n.z),r}},{key:"multiply",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new e;return r.set(t.x*n,t.y*n,t.z*n),r}},{key:"divide",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new e;return r.set(t.x*n,t.y*n,t.z*n),r}},{key:"dot",value:function(e,t){return e.x*t.x+e.y*t.y+e.z*t.z}},{key:"cross",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new e;return r.set(t.y*n.z-n.y*t.z,t.z*n.x-n.z*t.x,t.x*n.y-n.x*t.y),r}},{key:"dist",value:function(e,t){var n=e.x-t.x,r=e.y-t.y,i=e.z-t.z;return Math.sqrt(n*n+r*r+i*i)}}]),createClass(e,[{key:"get",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new e;return t.set(this.x,this.y,this.z),t}},{key:"set",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.x=e,this.y=t,this.z=n}},{key:"multiply",value:function(e){this.x=this.x*e,this.y=this.y*e,this.z=this.z*e}},{key:"add",value:function(e){this.x=this.x+e.x,this.y=this.y+e.y,this.z=this.z+e.z}},{key:"subtract",value:function(t){var n=new e(t.x,t.y,t.z);n.negate(),this.add(n)}},{key:"divide",value:function(e){e=1/e,this.multiply(e)}},{key:"negate",value:function(){this.x=-this.x,this.y=-this.y,this.z=-this.z}},{key:"clamp",value:function(e){this.x>e?this.x=e:this.x<0&&this.x<e&&(this.x=-e),this.y>e?this.y=e:this.y<0&&this.y<e&&(this.y=-e),this.z>e?this.z=e:this.z<0&&this.z<e&&(this.z=-e)}},{key:"limit",value:function(e){this.magnitude()>e&&(this.normalize(),this.multiply(e))}},{key:"rotate",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new e,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.magnitude(),o=Convert.degreesToRadians(t),a=Math.cos(o),s=Math.sin(o);this.x=a*(this.x-n.x)+s*(this.y-n.y)+n.x,this.y=a*(this.y-n.y)-s*(this.x-n.x)+n.y,r&&(this.normalize(),this.multiply(i))}},{key:"magnitude",value:function(){return Math.sqrt(e.dot(this,this))}},{key:"normalize",value:function(){var e=this.magnitude();e>0&&this.divide(e)}},{key:"x",get:function(){return this.raw[0]},set:function(e){this.raw[0]=e}},{key:"y",get:function(){return this.raw[1]},set:function(e){this.raw[1]=e}},{key:"z",get:function(){return this.raw[2]},set:function(e){this.raw[2]=e}}]),e}(),Matrix3=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[1,0,0,0,1,0,0,0,1];classCallCheck(this,e),this.raw=new Float32Array(t)}return createClass(e,[{key:"setMatrix",value:function(e){this.raw=e}},{key:"multiply",value:function(t){var n=e.multiply(this,t);this.raw=n.raw}},{key:"column1",get:function(){return[this.raw[0],this.raw[3],this.raw[6]]},set:function(e){this.raw[0]=e[0],this.raw[3]=e[1],this.raw[6]=e[2]}},{key:"column2",get:function(){return[this.raw[1],this.raw[4],this.raw[7]]},set:function(e){this.raw[1]=e[0],this.raw[4]=e[1],this.raw[7]=e[2]}},{key:"column3",get:function(){return[this.raw[2],this.raw[5],this.raw[8]]},set:function(e){this.raw[2]=e[0],this.raw[5]=e[1],this.raw[68]=e[2]}},{key:"row1",get:function(){return[this.raw[0],this.raw[1],this.raw[2]]},set:function(e){this.raw[0]=e[0],this.raw[1]=e[1],this.raw[2]=e[2]}},{key:"row2",get:function(){return[this.raw[3],this.raw[4],this.raw[5]]},set:function(e){this.raw[3]=e[0],this.raw[4]=e[1],this.raw[5]=e[2]}},{key:"row3",get:function(){return[this.raw[6],this.raw[7],this.raw[8]]},set:function(e){this.raw[6]=e[0],this.raw[7]=e[1],this.raw[8]=e[2]}}],[{key:"dot",value:function(e,t){var n=e[0]*t[0]+e[1]*t[1]+e[2]*t[2];return console.log(n),n}},{key:"multiply",value:function(t,n){var r=new Float32Array(9);r[0]=e.dot(t.column1,n.row1),r[1]=e.dot(t.column2,n.row1),r[2]=e.dot(t.column3,n.row1),r[3]=e.dot(t.column1,n.row2),r[4]=e.dot(t.column2,n.row2),r[5]=e.dot(t.column3,n.row2),r[6]=e.dot(t.column1,n.row3),r[7]=e.dot(t.column2,n.row3),r[8]=e.dot(t.column3,n.row3);var i=new e;return i.setMatrix(r),i}}]),e}(),Matrix4=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);classCallCheck(this,e),this.setMatrix(t)}return createClass(e,[{key:"setMatrix",value:function(e){this.raw=e}},{key:"transpose",value:function(){var e=[this.raw[0],this.raw[1],this.raw[2],this.raw[3]],t=[this.raw[4],this.raw[5],this.raw[6],this.raw[7]],n=[this.raw[8],this.raw[9],this.raw[10],this.raw[11]],r=[this.raw[12],this.raw[13],this.raw[14],this.raw[15]];this.raw[0]=e[0],this.raw[4]=e[1],this.raw[8]=e[2],this.raw[12]=e[3],this.raw[1]=t[0],this.raw[5]=t[1],this.raw[9]=t[2],this.raw[13]=t[3],this.raw[2]=n[0],this.raw[6]=n[1],this.raw[10]=n[2],this.raw[14]=n[3],this.raw[3]=r[0],this.raw[7]=r[1],this.raw[11]=r[2],this.raw[15]=r[3]}},{key:"multiply",value:function(t){e.multiply(this,t,this)}}],[{key:"dot",value:function(e,t,n,r,i,o,a,s){return e*i+t*o+n*a+r*s}},{key:"multiply",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new e,i=new Float32Array(16);return i[0]=e.dot(t.raw[0],t.raw[4],t.raw[8],t.raw[12],n.raw[0],n.raw[1],n.raw[2],n.raw[3]),i[1]=e.dot(t.raw[1],t.raw[5],t.raw[9],t.raw[13],n.raw[0],n.raw[1],n.raw[2],n.raw[3]),i[2]=e.dot(t.raw[2],t.raw[6],t.raw[10],t.raw[14],n.raw[0],n.raw[1],n.raw[2],n.raw[3]),i[3]=e.dot(t.raw[3],t.raw[7],t.raw[11],t.raw[15],n.raw[0],n.raw[1],n.raw[2],n.raw[3]),i[4]=e.dot(t.raw[0],t.raw[4],t.raw[8],t.raw[12],n.raw[4],n.raw[5],n.raw[6],n.raw[7]),i[5]=e.dot(t.raw[1],t.raw[5],t.raw[9],t.raw[13],n.raw[4],n.raw[5],n.raw[6],n.raw[7]),i[6]=e.dot(t.raw[2],t.raw[6],t.raw[10],t.raw[14],n.raw[4],n.raw[5],n.raw[6],n.raw[7]),i[7]=e.dot(t.raw[3],t.raw[7],t.raw[11],t.raw[15],n.raw[4],n.raw[5],n.raw[6],n.raw[7]),i[8]=e.dot(t.raw[0],t.raw[4],t.raw[8],t.raw[12],n.raw[8],n.raw[9],n.raw[10],n.raw[11]),i[9]=e.dot(t.raw[1],t.raw[5],t.raw[9],t.raw[13],n.raw[8],n.raw[9],n.raw[10],n.raw[11]),i[10]=e.dot(t.raw[2],t.raw[6],t.raw[10],t.raw[14],n.raw[8],n.raw[9],n.raw[10],n.raw[11]),i[11]=e.dot(t.raw[3],t.raw[7],t.raw[11],t.raw[15],n.raw[8],n.raw[9],n.raw[10],n.raw[11]),i[12]=e.dot(t.raw[0],t.raw[4],t.raw[8],t.raw[12],n.raw[12],n.raw[13],n.raw[14],n.raw[15]),i[13]=e.dot(t.raw[1],t.raw[5],t.raw[9],t.raw[13],n.raw[12],n.raw[13],n.raw[14],n.raw[15]),i[14]=e.dot(t.raw[2],t.raw[6],t.raw[10],t.raw[14],n.raw[12],n.raw[13],n.raw[14],n.raw[15]),i[15]=e.dot(t.raw[3],t.raw[7],t.raw[11],t.raw[15],n.raw[12],n.raw[13],n.raw[14],n.raw[15]),r.setMatrix(i),r}}]),e}(),hexString="0123456789abcdef",Generate=function(){function e(){classCallCheck(this,e)}return createClass(e,null,[{key:"randomHexString",value:function(e){for(var t="",n=0;n<e;n++)t+=hexString.substr(Math.floor(Math.random()*hexString.length),1);return t}},{key:"UUID",value:function(){return e.randomHexString(7)+"-"+e.randomHexString(4)+"-"+e.randomHexString(4)+"-"+e.randomHexString(4)+"-"+e.randomHexString(4)+"-"+e.randomHexString(12)}}]),e}(),pools=new Object,objectPool=new Object,usagePool=new Object,clean=new Object,Pool=function(){function e(){classCallCheck(this,e)}return createClass(e,null,[{key:"allocate",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e){return e};if(e.hasOwnProperty("prototype")){pools[t]={object:e,objectKey:t,amount:n,cleaner:r},clean[t]=r,usagePool[t]=[],objectPool[t]=[];for(var i=0;i<n;i++){var o=new e;o.v_pool_index=i,o.v_pool_key=t,usagePool[t][i]=!1,objectPool[t][i]=o}return objectPool[t]}throw new Error("Object must have a constructor")}},{key:"deallocate",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];0==e.referencesInPool(t)||1==n?(delete clean[t],delete usagePool[t],delete objectPool[t],delete pools[t]):console.warn("You still have objects in this pool checked out. Return them and call deallocate. Or use deallocate(key, true) to force deallocation.")}},{key:"referencesInPool",value:function(t){return pools[t].amount-e.poolsize(t)}},{key:"poolsize",value:function(t){return objectPool[t].filter(e.notInUse).length}},{key:"inUse",value:function(e){return usagePool[e.v_pool_key][e.v_pool_index]}},{key:"notInUse",value:function(e){return!usagePool[e.v_pool_key][e.v_pool_index]}},{key:"returnAll",value:function(t){for(var n=objectPool[t].filter(e.inUse),r=0;r<n.length;r++)e.returnObject(n[r])}},{key:"getObject",value:function(e){var t=usagePool[e].indexOf(!1);if(usagePool[e][t]=!0,t>-1)return objectPool[e][t];throw new Error("Out of objects")}},{key:"returnObject",value:function(e){clean[e.v_pool_key](e),usagePool[e.v_pool_key][e.v_pool_index]=!1}},{key:"returnObjects",value:function(t){for(var n=0;n<t.length;n++)e.returnObject(t[n])}},{key:"Pools",get:function(){return pools}}]),e}(),key=Generate.UUID(),Behavior=function(){function e(){classCallCheck(this,e)}return createClass(e,null,[{key:"init",value:function(){Pool.allocate(Vector3,key,10,Vector3.reset)}},{key:"seek",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=Pool.getObject(key),i=Pool.getObject(key);Vector3.subtract(t,e.location,r),r.normalize(),r.multiply(e.maxSpeed),Vector3.subtract(r,e.velocity,i),i.limit(e.maxForce),i.multiply(n),e.addForce(i),Pool.returnObject(r),Pool.returnObject(i)}},{key:"arrive",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=Pool.getObject(key),o=Pool.getObject(key);Vector3.subtract(t,e.location,i);var a=Convert.MapRange(i.magnitude(),0,n,0,e.maxSpeed);i.normalize(),i.multiply(a),Vector3.subtract(i,e.velocity,o),o.limit(e.maxForce),o.multiply(r),e.addForce(o),Pool.returnObject(i),Pool.returnObject(o)}},{key:"avoidAll",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:80,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=Pool.getObject(key),o=Pool.getObject(key),a=Pool.getObject(key),s=0,l=0;l<t.length;l++){var u=t[l],c=Vector3.dist(e.location,u.location);c>0&&c<n&&e.id!=u.id&&(Vector3.subtract(e.location,u.location,i),i.normalize(),i.divide(c),a.add(i),s++)}s>0&&(a.divide(s),a.normalize(),a.multiply(e.maxSpeed),Vector3.subtract(a,e.velocity,o),o.limit(e.maxForce),o.multiply(r),e.addForce(o)),Pool.returnObject(i),Pool.returnObject(o),Pool.returnObject(a)}},{key:"avoid",value:function(e,t,n){this.avoidAll(e,[t],n)}},{key:"constrain",value:function(e,t,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;t-=o,r+=o,n-=o,i+=o,e.location.x<t&&(e.velocity.x*=-1,e.location.x=t),e.location.y<n&&(e.velocity.y*=-1,e.location.y=n),e.location.x>r&&(e.velocity.x*=-1,e.location.x=r),e.location.y>i&&(e.velocity.y*=-1,e.location.y=i)}},{key:"wrap",value:function(e,t,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;t-=o,r+=o,n-=o,i+=o,e.location.x<t&&(e.location.x=r),e.location.y<n&&(e.location.y=i),e.location.x>r&&(e.location.x=t),e.location.y>i&&(e.location.y=n)}},{key:"disableOutside",value:function(e,t,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;t-=o,r+=o,n-=o,i+=o,(e.location.x<t||e.location.y<n||e.location.x>r||e.location.y>i)&&(e.active=!1,e.visible=!1)}},{key:"destroyOutside",value:function(e,t,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;t-=o,r+=o,n-=o,i+=o,(e.location.x<t||e.location.y<n||e.location.x>r||e.location.y>i)&&(e.dead=!0)}}]),e}();Behavior.init();var Actor=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Vector3(0,0,0);classCallCheck(this,e),this.type=t,this.active=!0,this.visible=!0,this.dead=!1,this.id=Generate.UUID(),this.location=n,this.velocity=new Vector3(0,0,0),this.acceleration=new Vector3(0,0,0),this.angle=0,this.maxSpeed=15,this.maxForce=1,this.parent=null,this.children=[]}return createClass(e,[{key:"addForce",value:function(e){this.acceleration.add(e)}},{key:"update",value:function(){this.active&&(this.move(),this.velocity.add(this.acceleration),this.location.add(this.velocity),this.acceleration.set(0,0,0))}},{key:"move",value:function(){}},{key:"render",value:function(){this.visible&&this.draw()}},{key:"draw",value:function(){}},{key:"destroy",value:function(){this.dead=!0;for(var e=0;e<this.children.length;e++)this.children[e].destroy()}}]),e}(),DOMActor=function(e){function t(e,n){classCallCheck(this,t);var r=possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.element=document.createElement("div"),r.element.classList.add("actor"),r.element.classList.add(e),r.parentElement=null,r}return inherits(t,e),createClass(t,[{key:"addToParentElement",value:function(e){this.parentElement=e,this.parentElement.appendChild(this.element)}},{key:"draw",value:function(){this.element.style.transform="translateX("+this.location.x+"px) translateY("+this.location.y+"px) rotate("+this.angle+"deg)"}},{key:"destroy",value:function(){this.dead=!0,this.element.remove(),this.parentElement=null}}]),t}(Actor),GameLoop=function(){function e(){classCallCheck(this,e),this.gameObjects=[],this.controller=[]}return createClass(e,[{key:"setController",value:function(e){this.controller.push(e)}},{key:"getType",value:function(e){for(var t=[],n=0;n<this.gameObjects.length;n++)this.gameObjects[n].type===e&&t.push(this.gameObjects[n]);return t}},{key:"update",value:function(){this.removeActors();for(var e=0;e<this.gameObjects.length;e++)this.gameObjects[e].update()}},{key:"addActor",value:function(e){this.gameObjects.push(e)}},{key:"removeActors",value:function(){for(var e=0;e<this.gameObjects.length;e++)this.gameObjects[e].dead&&this.gameObjects.splice(e,1)}},{key:"render",value:function(){for(var e=0;e<this.gameObjects.length;e++)this.gameObjects[e].render()}},{key:"loop",value:function(){this.update(),this.render(),window.requestAnimationFrame(this.loop.bind(this))}}]),e}(),listeners={},EventLite=function(){function e(){classCallCheck(this,e)}return createClass(e,null,[{key:"on",value:function(e,t){return void 0===listeners[e]?listeners[e]=[t]:listeners[e].push(t),t}},{key:"off",value:function(e,t){if(listeners[e])for(var n=listeners[e].length-1;n>=0;n--){if(1!==listeners[e].length){listeners[e].splice(n,1);break}delete listeners[e]}}},{key:"trigger",value:function(e){if(listeners[e]){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var i=listeners[e].length-1;i>=0;i--)if(void 0!==listeners[e]){if("function"!=typeof listeners[e][i]||!listeners[e][i])throw"Event handler is not a function.";listeners[e][i](n)}}}},{key:"unbindAll",value:function(){for(var e in listeners)delete listeners[e];return!0}}]),e}(),resizeId,resizeEvent,Screen=function(){function e(){classCallCheck(this,e)}return createClass(e,null,[{key:"resize",value:function(t){clearTimeout(resizeId),resizeEvent=t,resizeId=setTimeout(e.recalculate,e.resizeDelay)}},{key:"recalculate",value:function(){e.dimensions.set(window.innerWidth,window.innerHeight),e.dimensions.x>e.dimensions.y?e.orientation="landscape":e.orientation="portrait";for(var t in e.anchors)e.anchors.hasOwnProperty(t)&&e.anchorPositions[t].set(e.anchors[t].x*e.dimensions.x,e.anchors[t].y*e.dimensions.y);EventLite.trigger("resize",resizeEvent)}},{key:"getAnchor",value:function(t){return e.anchorPositions[t].get()}},{key:"setAnchor",value:function(t,n,r){void 0==e.anchors[t]?(e.anchors[t]=new Vector3(n,r),e.anchorPositions[t]=new Vector3(e.anchors[t].x*e.dimensions.x,e.anchors[t].y*e.dimensions.y)):(e.anchors[t].set(n,r),e.anchorPositions[t].set(e.anchors[t].x*e.dimensions.x,e.anchors[t].y*e.dimensions.y))}},{key:"removeAnchor",value:function(t){delete e.anchors[t],delete e.anchorPositions[t]}},{key:"init",value:function(){e.resizeDelay=100,e.anchors={},e.anchorPositions={},e.dimensions=new Vector3(window.innerWidth,window.innerHeight),e.setAnchor("center",.5,.5),e.dimensions.x>e.dimensions.y?e.orientation="landscape":e.orientation="portrait"}},{key:"dimensions",get:function(){return e._dimensions},set:function(t){e._dimensions!=t&&(e._dimensions=t)}},{key:"orientation",get:function(){return e._orientation},set:function(t){e._orientation!=t&&(e._orientation=t)}},{key:"center",get:function(){return e._center},set:function(t){e._center!=t&&(e._center=t)}},{key:"resizeDelay",get:function(){return e._resizeDelay},set:function(t){e._resizeDelay!=t&&(e._resizeDelay=t)}},{key:"anchors",get:function(){return e._anchors},set:function(t){e._anchors!=t&&(e._anchors=t)}},{key:"anchorPositions",get:function(){return e._anchorPositions},set:function(t){e._anchorPositions!=t&&(e._anchorPositions=t)}}]),e}();Screen.init();var InputController=function(){function e(){classCallCheck(this,e),this.keyMap={},this.mousePos=new Vector3}return createClass(e,[{key:"bindEvents",value:function(){document.addEventListener("mouseup",this.setMouseUp.bind(this)),document.addEventListener("mousedown",this.setMouseDown.bind(this)),document.addEventListener("mousemove",this.setMousePos.bind(this)),onkeydown=onkeyup=this.mapKeys.bind(this)}},{key:"unbindEvents",value:function(){document.removeEventListener("mouseup",this.setMouseUp.bind(this)),document.removeEventListener("mousedown",this.setMouseDown.bind(this)),document.removeEventListener("mousemove",this.setMousePos.bind(this)),onkeydown=onkeyup=null}},{key:"setMousePos",value:function(e){this.mousePos.set(e.pageX,e.pageY)}},{key:"setMouseUp",value:function(e){var t={key:"mouse"+e.button,type:"keyup"};this.mapKeys(t)}},{key:"setMouseDown",value:function(e){var t={key:"mouse"+e.button,type:"keydown"};this.mapKeys(t)}},{key:"mapKeys",value:function(e){e=e||event,this.keyMap[e.key]="keydown"==e.type}},{key:"keyUp",value:function(e){console.log(e)}},{key:"keyDown",value:function(e){console.log(e)}},{key:"setKeys",value:function(){for(var e in this.keyMap)this.keyMap[e]?this.keyDown(e):this.keyUp(e)}}]),e}();exports.Vector2=Vector2,exports.Vector3=Vector3,exports.Matrix3=Matrix3,exports.Matrix4=Matrix4,exports.Behaviors=Behavior,exports.Actor=Actor,exports.DOMActor=DOMActor,exports.GameLoop=GameLoop,exports.Screen=Screen,exports.InputController=InputController,exports.EventLite=EventLite,exports.Pool=Pool;