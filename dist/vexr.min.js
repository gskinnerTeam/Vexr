!function(t){"use strict";var e=(function(){function t(t){this.value=t}function e(e){function n(t,e){return new Promise(function(n,r){var s={key:t,arg:e,resolve:n,reject:r,next:null};a?a=a.next=s:(o=a=s,i(t,e))})}function i(n,o){try{var a=e[n](o),s=a.value;s instanceof t?Promise.resolve(s.value).then(function(t){i("next",t)},function(t){i("throw",t)}):r(a.done?"return":"normal",a.value)}catch(t){r("throw",t)}}function r(t,e){switch(t){case"return":o.resolve({value:e,done:!0});break;case"throw":o.reject(e);break;default:o.resolve({value:e,done:!1})}o=o.next,o?i(o.key,o.arg):a=null}var o,a;this._invoke=n,"function"!=typeof e.return&&(this.return=void 0)}return"function"==typeof Symbol&&Symbol.asyncIterator&&(e.prototype[Symbol.asyncIterator]=function(){return this}),e.prototype.next=function(t){return this._invoke("next",t)},e.prototype.throw=function(t){return this._invoke("throw",t)},e.prototype.return=function(t){return this._invoke("return",t)},{wrap:function(t){return function(){return new e(t.apply(this,arguments))}},await:function(e){return new t(e)}}}(),function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}),n=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),i=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},o=function(){function t(){e(this,t)}return n(t,null,[{key:"RadiansToDegrees",value:function(t){return t*(180/Math.PI)}},{key:"DegreesToRadians",value:function(t){return t*(Math.PI/180)}},{key:"MapRange",value:function(t,e,n,i,r){return i+(r-i)*(t-e)/(n-e)}}]),t}(),a=function(){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e(this,t),this.raw=[n,i]}return n(t,null,[{key:"angleBetween",value:function(e,n){var i=e.magnitude()*n.magnitude(),r=t.dot(e,n);return Math.acos(r/i)}},{key:"lerp",value:function(e,n,i){var r=e.x+i*(n.x-e.x),o=e.y+i*(n.y-e.y);return new t(r,o)}},{key:"normalize",value:function(t){var e=t.get();return e.normalize(),e}},{key:"magnitude",value:function(e){return Math.sqrt(t.dot(e,e))}},{key:"add",value:function(e,n){return new t(e.x+n.x,e.y+n.y)}},{key:"subtract",value:function(e,n){var i=new t(n.x,n.y);return i.negate(),t.add(e,i)}},{key:"multiply",value:function(e,n){return new t(e.x*n,e.y*n)}},{key:"divide",value:function(e,n){return n=1/n,t.multiply(e,n)}},{key:"dot",value:function(t,e){return t.x*e.x+t.y*e.y}},{key:"dist",value:function(t,e){var n=t.x-e.x,i=t.y-e.y;return Math.sqrt(n*n+i*i)}}]),n(t,[{key:"get",value:function(){return new t(this.x,this.y)}},{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.x=t,this.y=e}},{key:"multiply",value:function(t){this.x=this.x*t,this.y=this.y*t}},{key:"add",value:function(t){this.x=this.x+t.x,this.y=this.y+t.y}},{key:"subtract",value:function(e){var n=new t(e.x,e.y);n.negate(),this.add(n)}},{key:"divide",value:function(t){t=1/t,this.multiply(t)}},{key:"negate",value:function(){this.x=-this.x,this.y=-this.y}},{key:"clamp",value:function(t){this.x>t?this.x=t:this.x<0&&this.x<t&&(this.x=-t),this.y>t?this.y=t:this.y<0&&this.y<t&&(this.y=-t)}},{key:"limit",value:function(t){this.magnitude()>t&&(this.normalize(),this.multiply(t))}},{key:"rotate",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new t(0,0),i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.magnitude(),a=o.degreesToRadians(e),s=Math.cos(a),u=Math.sin(a);this.x=s*(this.x-n.x)+u*(this.y-n.y)+n.x,this.y=s*(this.y-n.y)-u*(this.x-n.x)+n.y,i&&(this.normalize(),this.multiply(r))}},{key:"magnitude",value:function(){return Math.sqrt(t.dot(this,this))}},{key:"normalize",value:function(){var t=this.magnitude();t>0&&this.divide(t)}},{key:"x",get:function(){return this.raw[0]},set:function(t){this.raw[0]=t}},{key:"y",get:function(){return this.raw[1]},set:function(t){this.raw[1]=t}},{key:"z",get:function(){return 0}}]),t}(),s=function(){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;e(this,t),this.raw=[n,i,r]}return n(t,null,[{key:"reset",value:function(t){t.set(0,0,0)}},{key:"angleBetween",value:function(e,n){var i=e.magnitude()*n.magnitude(),r=t.dot(e,n);return Math.acos(r/i)}},{key:"lerp",value:function(e,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new t;return r.set(e.x+i*(n.x-e.x),e.y+i*(n.y-e.y),e.z+i*(n.z-e.z)),r}},{key:"normalize",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new t,i=e.get(n);return i.normalize(),i}},{key:"magnitude",value:function(e){return Math.sqrt(t.dot(e,e))}},{key:"add",value:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new t;return i.set(e.x+n.x,e.y+n.y,e.z+n.z),i}},{key:"subtract",value:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new t;return i.set(e.x-n.x,e.y-n.y,e.z-n.z),i}},{key:"multiply",value:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new t;return i.set(e.x*n,e.y*n,e.z*n),i}},{key:"divide",value:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new t;return i.set(e.x*n,e.y*n,e.z*n),i}},{key:"dot",value:function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z}},{key:"cross",value:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new t;return i.set(e.y*n.z-n.y*e.z,e.z*n.x-n.z*e.x,e.x*n.y-n.x*e.y),i}},{key:"dist",value:function(t,e){var n=t.x-e.x,i=t.y-e.y,r=t.z-e.z;return Math.sqrt(n*n+i*i+r*r)}}]),n(t,[{key:"get",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new t;return e.set(this.x,this.y,this.z),e}},{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.x=t,this.y=e,this.z=n}},{key:"multiply",value:function(t){this.x=this.x*t,this.y=this.y*t,this.z=this.z*t}},{key:"add",value:function(t){this.x=this.x+t.x,this.y=this.y+t.y,this.z=this.z+t.z}},{key:"subtract",value:function(e){var n=new t(e.x,e.y,e.z);n.negate(),this.add(n)}},{key:"divide",value:function(t){t=1/t,this.multiply(t)}},{key:"negate",value:function(){this.x=-this.x,this.y=-this.y,this.z=-this.z}},{key:"clamp",value:function(t){this.x>t?this.x=t:this.x<0&&this.x<t&&(this.x=-t),this.y>t?this.y=t:this.y<0&&this.y<t&&(this.y=-t),this.z>t?this.z=t:this.z<0&&this.z<t&&(this.z=-t)}},{key:"limit",value:function(t){this.magnitude()>t&&(this.normalize(),this.multiply(t))}},{key:"rotate",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new t,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.magnitude(),a=o.degreesToRadians(e),s=Math.cos(a),u=Math.sin(a);this.x=s*(this.x-n.x)+u*(this.y-n.y)+n.x,this.y=s*(this.y-n.y)-u*(this.x-n.x)+n.y,i&&(this.normalize(),this.multiply(r))}},{key:"magnitude",value:function(){return Math.sqrt(t.dot(this,this))}},{key:"normalize",value:function(){var t=this.magnitude();t>0&&this.divide(t)}},{key:"x",get:function(){return this.raw[0]},set:function(t){this.raw[0]=t}},{key:"y",get:function(){return this.raw[1]},set:function(t){this.raw[1]=t}},{key:"z",get:function(){return this.raw[2]},set:function(t){this.raw[2]=t}}]),t}(),u=function(){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[1,0,0,0,1,0,0,0,1];e(this,t),this.raw=new Float32Array(n)}return n(t,[{key:"setMatrix",value:function(t){this.raw=t}},{key:"multiply",value:function(e){var n=t.multiply(this,e);this.raw=n.raw}},{key:"column1",get:function(){return[this.raw[0],this.raw[3],this.raw[6]]},set:function(t){this.raw[0]=t[0],this.raw[3]=t[1],this.raw[6]=t[2]}},{key:"column2",get:function(){return[this.raw[1],this.raw[4],this.raw[7]]},set:function(t){this.raw[1]=t[0],this.raw[4]=t[1],this.raw[7]=t[2]}},{key:"column3",get:function(){return[this.raw[2],this.raw[5],this.raw[8]]},set:function(t){this.raw[2]=t[0],this.raw[5]=t[1],this.raw[68]=t[2]}},{key:"row1",get:function(){return[this.raw[0],this.raw[1],this.raw[2]]},set:function(t){this.raw[0]=t[0],this.raw[1]=t[1],this.raw[2]=t[2]}},{key:"row2",get:function(){return[this.raw[3],this.raw[4],this.raw[5]]},set:function(t){this.raw[3]=t[0],this.raw[4]=t[1],this.raw[5]=t[2]}},{key:"row3",get:function(){return[this.raw[6],this.raw[7],this.raw[8]]},set:function(t){this.raw[6]=t[0],this.raw[7]=t[1],this.raw[8]=t[2]}}],[{key:"dot",value:function(t,e){var n=t[0]*e[0]+t[1]*e[1]+t[2]*e[2];return console.log(n),n}},{key:"multiply",value:function(e,n){var i=new Float32Array(9);i[0]=t.dot(e.column1,n.row1),i[1]=t.dot(e.column2,n.row1),i[2]=t.dot(e.column3,n.row1),i[3]=t.dot(e.column1,n.row2),i[4]=t.dot(e.column2,n.row2),i[5]=t.dot(e.column3,n.row2),i[6]=t.dot(e.column1,n.row3),i[7]=t.dot(e.column2,n.row3),i[8]=t.dot(e.column3,n.row3);var r=new t;return r.setMatrix(i),r}}]),t}(),l=function(){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);e(this,t),this.setMatrix(n)}return n(t,[{key:"setMatrix",value:function(t){this.raw=t}},{key:"transpose",value:function(){var t=[this.raw[0],this.raw[1],this.raw[2],this.raw[3]],e=[this.raw[4],this.raw[5],this.raw[6],this.raw[7]],n=[this.raw[8],this.raw[9],this.raw[10],this.raw[11]],i=[this.raw[12],this.raw[13],this.raw[14],this.raw[15]];this.raw[0]=t[0],this.raw[4]=t[1],this.raw[8]=t[2],this.raw[12]=t[3],this.raw[1]=e[0],this.raw[5]=e[1],this.raw[9]=e[2],this.raw[13]=e[3],this.raw[2]=n[0],this.raw[6]=n[1],this.raw[10]=n[2],this.raw[14]=n[3],this.raw[3]=i[0],this.raw[7]=i[1],this.raw[11]=i[2],this.raw[15]=i[3]}},{key:"multiply",value:function(e){t.multiply(this,e,this)}}],[{key:"dot",value:function(t,e,n,i,r,o,a,s){return t*r+e*o+n*a+i*s}},{key:"multiply",value:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new t,r=new Float32Array(16);return r[0]=t.dot(e.raw[0],e.raw[4],e.raw[8],e.raw[12],n.raw[0],n.raw[1],n.raw[2],n.raw[3]),r[1]=t.dot(e.raw[1],e.raw[5],e.raw[9],e.raw[13],n.raw[0],n.raw[1],n.raw[2],n.raw[3]),r[2]=t.dot(e.raw[2],e.raw[6],e.raw[10],e.raw[14],n.raw[0],n.raw[1],n.raw[2],n.raw[3]),r[3]=t.dot(e.raw[3],e.raw[7],e.raw[11],e.raw[15],n.raw[0],n.raw[1],n.raw[2],n.raw[3]),r[4]=t.dot(e.raw[0],e.raw[4],e.raw[8],e.raw[12],n.raw[4],n.raw[5],n.raw[6],n.raw[7]),r[5]=t.dot(e.raw[1],e.raw[5],e.raw[9],e.raw[13],n.raw[4],n.raw[5],n.raw[6],n.raw[7]),r[6]=t.dot(e.raw[2],e.raw[6],e.raw[10],e.raw[14],n.raw[4],n.raw[5],n.raw[6],n.raw[7]),r[7]=t.dot(e.raw[3],e.raw[7],e.raw[11],e.raw[15],n.raw[4],n.raw[5],n.raw[6],n.raw[7]),r[8]=t.dot(e.raw[0],e.raw[4],e.raw[8],e.raw[12],n.raw[8],n.raw[9],n.raw[10],n.raw[11]),r[9]=t.dot(e.raw[1],e.raw[5],e.raw[9],e.raw[13],n.raw[8],n.raw[9],n.raw[10],n.raw[11]),r[10]=t.dot(e.raw[2],e.raw[6],e.raw[10],e.raw[14],n.raw[8],n.raw[9],n.raw[10],n.raw[11]),r[11]=t.dot(e.raw[3],e.raw[7],e.raw[11],e.raw[15],n.raw[8],n.raw[9],n.raw[10],n.raw[11]),r[12]=t.dot(e.raw[0],e.raw[4],e.raw[8],e.raw[12],n.raw[12],n.raw[13],n.raw[14],n.raw[15]),r[13]=t.dot(e.raw[1],e.raw[5],e.raw[9],e.raw[13],n.raw[12],n.raw[13],n.raw[14],n.raw[15]),r[14]=t.dot(e.raw[2],e.raw[6],e.raw[10],e.raw[14],n.raw[12],n.raw[13],n.raw[14],n.raw[15]),r[15]=t.dot(e.raw[3],e.raw[7],e.raw[11],e.raw[15],n.raw[12],n.raw[13],n.raw[14],n.raw[15]),i.setMatrix(r),i}}]),t}(),c="0123456789abcdef",h=function(){function t(){e(this,t)}return n(t,null,[{key:"randomHexString",value:function(t){for(var e="",n=0;n<t;n++)e+=c.substr(Math.floor(Math.random()*c.length),1);return e}},{key:"UUID",value:function(){return t.randomHexString(7)+"-"+t.randomHexString(4)+"-"+t.randomHexString(4)+"-"+t.randomHexString(4)+"-"+t.randomHexString(4)+"-"+t.randomHexString(12)}}]),t}(),y=new Object,w=new Object,v=new Object,d=new Object,f=function(){function t(){e(this,t)}return n(t,null,[{key:"allocate",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(t){return t};if(t.hasOwnProperty("prototype")){y[e]={object:t,objectKey:e,amount:n,cleaner:i},d[e]=i,v[e]=[],w[e]=[];for(var r=0;r<n;r++){var o=new t;o.v_pool_index=r,o.v_pool_key=e,v[e][r]=!1,w[e][r]=o}return w[e]}throw new Error("Object must have a constructor")}},{key:"deallocate",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];0==t.referencesInPool(e)||1==n?(delete d[e],delete v[e],delete w[e],delete y[e]):console.warn("You still have objects in this pool checked out. Return them and call deallocate. Or use deallocate(key, true) to force deallocation.")}},{key:"referencesInPool",value:function(e){return y[e].amount-t.poolsize(e)}},{key:"poolsize",value:function(e){return w[e].filter(t.notInUse).length}},{key:"inUse",value:function(t){return v[t.v_pool_key][t.v_pool_index]}},{key:"notInUse",value:function(t){return!v[t.v_pool_key][t.v_pool_index]}},{key:"returnAll",value:function(e){for(var n=w[e].filter(t.inUse),i=0;i<n.length;i++)t.returnObject(n[i])}},{key:"getObject",value:function(t){var e=v[t].indexOf(!1);if(v[t][e]=!0,e>-1)return w[t][e];throw new Error("Out of objects")}},{key:"returnObject",value:function(t){d[t.v_pool_key](t),v[t.v_pool_key][t.v_pool_index]=!1}},{key:"returnObjects",value:function(e){for(var n=0;n<e.length;n++)t.returnObject(e[n])}},{key:"Pools",get:function(){return y}}]),t}(),m=h.UUID(),k=function(){function t(){e(this,t)}return n(t,null,[{key:"init",value:function(){f.allocate(s,m,10,s.reset)}},{key:"seek",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=f.getObject(m),r=f.getObject(m);s.subtract(e,t.location,i),i.normalize(),i.multiply(t.maxSpeed),s.subtract(i,t.velocity,r),r.limit(t.maxForce),r.multiply(n),t.addForce(r),f.returnObject(i),f.returnObject(r)}},{key:"arrive",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=f.getObject(m),a=f.getObject(m);s.subtract(e,t.location,r);var u=o.MapRange(r.magnitude(),0,n,0,t.maxSpeed);r.normalize(),r.multiply(u),s.subtract(r,t.velocity,a),a.limit(t.maxForce),a.multiply(i),t.addForce(a),f.returnObject(r),f.returnObject(a)}},{key:"avoidAll",value:function(t,e){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:80,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=f.getObject(m),o=f.getObject(m),a=f.getObject(m),u=0,l=0;l<e.length;l++){var c=e[l],h=s.dist(t.location,c.location);h>0&&h<n&&t.id!=c.id&&(s.subtract(t.location,c.location,r),r.normalize(),r.divide(h),a.add(r),u++)}u>0&&(a.divide(u),a.normalize(),a.multiply(t.maxSpeed),s.subtract(a,t.velocity,o),o.limit(t.maxForce),o.multiply(i),t.addForce(o)),f.returnObject(r),f.returnObject(o),f.returnObject(a)}},{key:"avoid",value:function(t,e,n){this.avoidAll(t,[e],n)}},{key:"constrain",value:function(t,e,n,i,r){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;e-=o,i+=o,n-=o,r+=o,t.location.x<e&&(t.velocity.x*=-1,t.location.x=e),t.location.y<n&&(t.velocity.y*=-1,t.location.y=n),t.location.x>i&&(t.velocity.x*=-1,t.location.x=i),t.location.y>r&&(t.velocity.y*=-1,t.location.y=r)}},{key:"wrap",value:function(t,e,n,i,r){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;e-=o,i+=o,n-=o,r+=o,t.location.x<e&&(t.location.x=i),t.location.y<n&&(t.location.y=r),t.location.x>i&&(t.location.x=e),t.location.y>r&&(t.location.y=n)}},{key:"disableOutside",value:function(t,e,n,i,r){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;e-=o,i+=o,n-=o,r+=o,(t.location.x<e||t.location.y<n||t.location.x>i||t.location.y>r)&&(t.active=!1,t.visible=!1)}},{key:"destroyOutside",value:function(t,e,n,i,r){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;e-=o,i+=o,n-=o,r+=o,(t.location.x<e||t.location.y<n||t.location.x>i||t.location.y>r)&&(t.dead=!0)}}]),t}();k.init();var g,p,x=function(){function t(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new s(0,0,0);e(this,t),this.type=n,this.active=!0,this.visible=!0,this.dead=!1,this.id=h.UUID(),this.location=i,this.velocity=new s(0,0,0),this.acceleration=new s(0,0,0),this.angle=0,this.maxSpeed=15,this.maxForce=1,this.parent=null,this.children=[]}return n(t,[{key:"addForce",value:function(t){this.acceleration.add(t)}},{key:"update",value:function(){this.active&&(this.move(),this.velocity.add(this.acceleration),this.location.add(this.velocity),this.acceleration.set(0,0,0))}},{key:"move",value:function(){}},{key:"render",value:function(){this.visible&&this.draw()}},{key:"draw",value:function(){}},{key:"destroy",value:function(){this.dead=!0;for(var t=0;t<this.children.length;t++)this.children[t].destroy()}}]),t}(),b=function(t){function o(t,n){e(this,o);var i=r(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,t,n));return i.element=document.createElement("div"),i.element.classList.add("actor"),i.element.classList.add(t),i.parentElement=null,i}return i(o,t),n(o,[{key:"addToParentElement",value:function(t){this.parentElement=t,this.parentElement.appendChild(this.element)}},{key:"draw",value:function(){this.element.style.transform="translateX("+this.location.x+"px) translateY("+this.location.y+"px) rotate("+this.angle+"deg)"}},{key:"destroy",value:function(){this.dead=!0,this.element.remove(),this.parentElement=null}}]),o}(x),z=function(){function t(){e(this,t),this.gameObjects=[],this.controller=[]}return n(t,[{key:"setController",value:function(t){this.controller.push(t)}},{key:"getType",value:function(t){for(var e=[],n=0;n<this.gameObjects.length;n++)this.gameObjects[n].type===t&&e.push(this.gameObjects[n]);return e}},{key:"update",value:function(){this.removeActors();for(var t=0;t<this.gameObjects.length;t++)this.gameObjects[t].update()}},{key:"addActor",value:function(t){this.gameObjects.push(t)}},{key:"removeActors",value:function(){for(var t=0;t<this.gameObjects.length;t++)this.gameObjects[t].dead&&this.gameObjects.splice(t,1)}},{key:"render",value:function(){for(var t=0;t<this.gameObjects.length;t++)this.gameObjects[t].render()}},{key:"loop",value:function(){this.update(),this.render(),window.requestAnimationFrame(this.loop.bind(this))}}]),t}(),O={},j=function(){function t(){e(this,t)}return n(t,null,[{key:"on",value:function(t,e){return void 0===O[t]?O[t]=[e]:O[t].push(e),e}},{key:"off",value:function(t,e){if(O[t])for(var n=O[t].length-1;n>=0;n--){if(1!==O[t].length){O[t].splice(n,1);break}delete O[t]}}},{key:"trigger",value:function(t){if(O[t]){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];for(var r=O[t].length-1;r>=0;r--)if(void 0!==O[t]){if("function"!=typeof O[t][r]||!O[t][r])throw"Event handler is not a function.";O[t][r](n)}}}},{key:"unbindAll",value:function(){for(var t in O)delete O[t];return!0}}]),t}(),_=function(){function t(){e(this,t)}return n(t,null,[{key:"resize",value:function(e){clearTimeout(g),p=e,g=setTimeout(t.recalculate,t.resizeDelay)}},{key:"recalculate",value:function(){t.dimensions.set(window.innerWidth,window.innerHeight),t.dimensions.x>t.dimensions.y?t.orientation="landscape":t.orientation="portrait";for(var e in t.anchors)t.anchors.hasOwnProperty(e)&&t.anchorPositions[e].set(t.anchors[e].x*t.dimensions.x,t.anchors[e].y*t.dimensions.y);j.trigger("resize",p)}},{key:"getAnchor",value:function(e){return t.anchorPositions[e].get()}},{key:"setAnchor",value:function(e,n,i){void 0==t.anchors[e]?(t.anchors[e]=new s(n,i),t.anchorPositions[e]=new s(t.anchors[e].x*t.dimensions.x,t.anchors[e].y*t.dimensions.y)):(t.anchors[e].set(n,i),t.anchorPositions[e].set(t.anchors[e].x*t.dimensions.x,t.anchors[e].y*t.dimensions.y))}},{key:"removeAnchor",value:function(e){delete t.anchors[e],delete t.anchorPositions[e]}},{key:"init",value:function(){t.resizeDelay=100,t.anchors={},t.anchorPositions={},t.dimensions=new s(window.innerWidth,window.innerHeight),t.setAnchor("center",.5,.5),t.dimensions.x>t.dimensions.y?t.orientation="landscape":t.orientation="portrait"}},{key:"dimensions",get:function(){return t._dimensions},set:function(e){t._dimensions!=e&&(t._dimensions=e)}},{key:"orientation",get:function(){return t._orientation},set:function(e){t._orientation!=e&&(t._orientation=e)}},{key:"center",get:function(){return t._center},set:function(e){t._center!=e&&(t._center=e)}},{key:"resizeDelay",get:function(){return t._resizeDelay},set:function(e){t._resizeDelay!=e&&(t._resizeDelay=e)}},{key:"anchors",get:function(){return t._anchors},set:function(e){t._anchors!=e&&(t._anchors=e)}},{key:"anchorPositions",get:function(){return t._anchorPositions},set:function(e){t._anchorPositions!=e&&(t._anchorPositions=e)}}]),t}();_.init();var M=function(){function t(){e(this,t),this.keyMap={},this.mousePos=new s}return n(t,[{key:"bindEvents",value:function(){document.addEventListener("mouseup",this.setMouseUp.bind(this)),document.addEventListener("mousedown",this.setMouseDown.bind(this)),document.addEventListener("mousemove",this.setMousePos.bind(this)),onkeydown=onkeyup=this.mapKeys.bind(this)}},{key:"unbindEvents",value:function(){document.removeEventListener("mouseup",this.setMouseUp.bind(this)),document.removeEventListener("mousedown",this.setMouseDown.bind(this)),document.removeEventListener("mousemove",this.setMousePos.bind(this)),onkeydown=onkeyup=null}},{key:"setMousePos",value:function(t){this.mousePos.set(t.pageX,t.pageY)}},{key:"setMouseUp",value:function(t){var e={key:"mouse"+t.button,type:"keyup"};this.mapKeys(e)}},{key:"setMouseDown",value:function(t){var e={key:"mouse"+t.button,type:"keydown"};this.mapKeys(e)}},{key:"mapKeys",value:function(t){t=t||event,this.keyMap[t.key]="keydown"==t.type}},{key:"keyUp",value:function(t){console.log(t)}},{key:"keyDown",value:function(t){console.log(t)}},{key:"setKeys",value:function(){for(var t in this.keyMap)this.keyMap[t]?this.keyDown(t):this.keyUp(t)}}]),t}();t.Vector2=a,t.Vector3=s,t.Matrix3=u,t.Matrix4=l,t.Behaviors=k,t.Actor=x,t.DOMActor=b,t.GameLoop=z,t.Screen=_,t.InputController=M,t.EventLite=j,t.Pool=f}(this.Vexr=this.Vexr||{});